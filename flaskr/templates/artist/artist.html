{% from "/_formhelpers.html" import render_field %}
{% extends "/base.html" %}
{% block content %}
{% for artist in artists %}

<div class="min-h-screen w-screen grid grid-cols-2 flex items-center p-8 md:p-12 xl:p-20 pt-20 md:pt-20 lg:pt-0 gap-8 box" id="{{ artist.name }}">
    <!-- singer -->
    <div class="h-screen lg:h-full col-span-2 lg:col-span-1 shadow-2xl rounded-lg box border-t-2 border-blue-300 p-4 sm:p-6">
        <!-- singer name -->
        <div class="h-1/5 box flex items-center">
            <div class="h-full w-full grid grid-cols-5">
                <div class="h-full col-span-1 flex items-center box lg:p-2">
                    <img src="{{ url_for('static', filename=artist.artist_picture_path) }}" class="w-full rounded-full border-solid border-4 border-blue-500">
                </div>
                <div class="h-full col-span-4 flex items-center box">
                    <div class="pl-1 sm:pl-4 2xl:pl-8 box">
                        <h3 class="text-xl sm:text-3xl md:text-4xl lg:text-3xl xl:text-4xl 2xl:text-5xl font-semibold">
                            {{ artist.name }} <span>{{ artist.name_j }}</span>
                        </h3>            
                    </div>
                </div>       
            </div>
        </div>
        <!-- singer desc -->
        <div class="h-1/5 flex items-center px-2 box">
            <p class="text-sm sm:text-base 2xl:text-xl">
                {{ artist.artist_info }}
            </p>
        </div>
        <!-- comments -->
        <div class="h-2/5 flex items-center py-4 px-2 box overflow-scroll">
            <div class="h-full w-full box">
                <div class="h-1/3 box">         
                    {% set isCommented = {'isCommented':False} %}
                    {% for comment in comments %}                       
                        {% if artist.id == comment.to_artist_id %}
                        <div class="h-full w-full grid grid-cols-9 box">
                            <div class="h-full col-span-1 flex items-center p-0 xl:p-2">
                                {% if comment.picture_path %}
                                <img src="{{ url_for('static', filename=comment.picture_path) }}" class="rounded-full border-solid border-2 xl:border-4 border-blue-500">
                                {% else %}
                                <img src="/static/image/logoa.jpg" class="rounded-full border-solid border-2 xl:border-4 border-blue-500">
                                {% endif %}
                            </div>
                            <div class="h-full col-span-8 flex items-center">
                                <div class="w-full mx-2 sm:mx-4 2xl:mx-8 py-1 2xl:py-3 px-3 2xl:px-6 bg-white rounded shadow text-blue-400">
                                    <p class="text-xs sm:text-sm lg:text-xs xl:text-sm 2xl:text-lg font-semibold">
                                        @{{ comment.username}}
                                    </p>
                                    <p class="text-xs sm:text-sm lg:text-xs xl:text-sm 2xl:text-base">{{ comment.comment }}</p>
                                </div>
                            </div>
                        </div>
                        {% if isCommented.update({'isCommented':True}) %}{% endif %}
                        {% endif %}
                    {% endfor %}

                    {% if not isCommented.isCommented %}                
                    <h2>There's no comment yet.</h2>
                    {% endif %}
                </div>
            </div>
        </div>

        <!-- add comment -->
        <div class="h-1/5 flex items-center px-2 box">
            <div class="h-full w-full grid grid-cols-9 box">

                {% if current_user.is_authenticated %}
                <div class="h-full col-span-1 flex items-center p-0 xl:p-2">
                    {% if current_user.picture_path %}
                    <img src="{{ url_for('static', filename=current_user.picture_path) }}" class="rounded-full border-solid border-2 xl:border-4 border-blue-500">
                    {% else %}
                    <img src="/static/image/logoa.jpg" class="rounded-full border-solid border-2 xl:border-4 border-blue-500">
                    {% endif %}
                </div>
                <div class="h-full col-span-8 flex items-center flex items-center">
                    <form method="POST" class="w-full mx-2 sm:mx-4 2xl:mx-8">
                        {{form.csrf_token}}
                        {{ form.to_artist_id(value=artist.id) }}
                        <!-- {{ form.username }} -->
                        <h4 class="text-base sm:text-lg 2xl:text-xl">
                            {{render_field(form.comment, rows="2", class="w-full text-xl text-gray-400 rounded shadow p-1 px-2 mt-1")}}
                        </h4>
                        <h4 class="text-base sm:text-lg 2xl:text-xl mt-2">
                            {{form.submit(class="bg-blue-400 hover:bg-blue-500 rounded-full outline-none py-2 px-4")}}
                        </h4>
                    </form>
                </div>
                {% else %}
                <div class="h-full col-span-1 flex items-center p-0 xl:p-2">
                    <img src="/static/image/logoa.jpg" class="rounded-full border-solid  border-2 xl:border-4 border-blue-500">
                </div>
                <div class="h-full col-span-8 flex items-center flex items-center">
                    <div class="w-full mx-2 sm:mx-4 2xl:mx-8">
                        <h4>You can add comment after you sign up!</h4>
                    </div>
                </div>
                {% endif %}                
            </div>
        </div>
    </div>

    <!-- song -->
    <div class="h-screen lg:h-full col-span-2 lg:col-span-1 shadow-2xl rounded-lg box border-t-2 border-blue-300 p-4 sm:p-6">
        <!-- song title -->
        <div class="h-1/5 box flex items-center">
            <div class="h-full w-full grid grid-cols-5">
                <div class="h-full col-span-1 flex items-center lg:p-2 box">
                    <img src="{{ url_for('static', filename=artist.song_picture_path) }}" alt="" class="w-full shadow">
                </div>
                <div class="h-full col-span-4 flex items-center box">
                    <div class="pl-2 sm:pl-4 2xl:pl-8 box">
                        <h4 class="text-lg sm:text-2xl lg:text-xl xl:text-2xl 2xl:text-4xl"><i class="fas fa-compact-disc mr-2"></i>{{ artist.year }}</h4>
                        <h4 class="text-base sm:text-2xl lg:text-xl xl:text-2xl 2xl:text-4xl pt-2">{{ artist.title }} <span>{{ artist.title_j }}</span></h4>
                    </div>
                </div>
            </div>
        </div>
        <!-- song youtube -->
        <div class="h-2/5 sm:h-3/5 lg:h-2/5 xl:h-3/5 flex items-center lg:p-2 2xl:pt-8 box">
            <iframe class="w-full h-full shadow rounded-lg  transform duration-700 ease-linear hover:scale-105" src="{{ artist.youtube }}" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
        </div>
        <!-- song desc -->
        <div class="h-2/5 sm:h-1/5 lg:h-2/5 xl:h-1/5 flex items-center px-2 box">
            <p class="text-base 2xl:text-xl">
                {{ artist.song_info }}
            </p>
        </div>
    </div>

</div>

{% endfor %}
{% endblock %}